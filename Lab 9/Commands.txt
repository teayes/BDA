CREATE EXTERNAL TABLE IF NOT EXISTS EMPLOYEE
(Emp_ID INT, Emp_Name STRING, Designation STRING, Salary INT)
COMMENT 'Employee Details'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE
LOCATION '/user/hadoop/employeedata/';

SELECT * FROM EMPLOYEE;

CREATE VIEW EMPLOYEE_30000 AS
SELECT * FROM EMPLOYEE
WHERE Salary>30000;

SELECT * FROM EMPLOYEE_30000;

ALTER TABLE EMPLOYEE ADD COLUMNS ( 
Dept_ID INT);

LOAD DATA LOCAL INPATH 'EmployeeDetailsWithDept.csv' OVERWRITE INTO TABLE EMPLOYEE;

SELECT * FROM EMPLOYEE;

ALTER TABLE EMPLOYEE REPLACE COLUMNS(Emp_ID INT, Emp_Name STRING, Designation STRING, Salary INT);

SELECT * FROM EMPLOYEE ORDER BY DEPT_ID;

SELECT Dept_ID, COUNT(*) FROM EMPLOYEE WHERE Salary>30000 GROUP BY DEPT_ID;

CREATE EXTERNAL TABLE IF NOT EXISTS DEPARTMENT
(Dept_ID INT, Dept_Name STRING, Emp_ID INT)
COMMENT 'Department Details'
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE
LOCATION '/user/hadoop/departmentdata/';

SELECT * FROM DEPARTMENT;

SELECT e.Emp_ID, e.Emp_Name, e.Designation, e.Salary, d.Dept_Name 
FROM EMPLOYEE e JOIN DEPARTMENT d 
ON (e.Emp_ID = d.Emp_ID);